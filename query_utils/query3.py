import sys
import openai
import time

openai.api_key = ""
f = open("/tmp/results.txt","w")
for line in open(sys.argv[1],'r').read().strip().split("\n"):
    lib = line.split(" ")[0]
    func = line.split(" ")[1]
    print(lib,func)
    #print("// What's the filename of the DLL that exports each one of the following functions: %s" % func)
    response = openai.Completion.create(
      engine="text-davinci-002",
      prompt="// What's the filename of the DLL that exports each one of the following functions: %s" % func,
      temperature=1,
      max_tokens=256,
      top_p=1,
      frequency_penalty=0.0,
      presence_penalty=0.0,
      stop=["#"]
    )
    if lib in response.choices[0].text:
        f.write("YES = %s\n" % lib)
        print("YES = %s\n" % lib)
    else:
        f.write("NO = %s\n" % lib)
        print("NO = %s\n" % lib)
    f.flush()
    time.sleep(10)
f.close()
