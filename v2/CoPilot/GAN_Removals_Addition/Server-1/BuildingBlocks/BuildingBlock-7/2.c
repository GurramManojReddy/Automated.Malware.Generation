//-----2-----

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <windows.h>
#define MAXSIZE 1024
int Decode_Base64(void *encoded, int size, void *decoded);
int Decode_Base64(void *encoded, int size, void *decoded)
{
    char *table = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
    int i, j, k;
    char *str = (char *)encoded;
    char *result = (char *)decoded;
    char temp[4];
    int num, count = 0;
    int total = 0;
    for (i = 0; i < size; i += 4)
    {
        strcpy(temp, str + i);
        for (j = 0; j < 4; j++)
        {
            for (k = 0; k < 64; k++)
            {
                if (temp[j] == table[k])
                {
                    temp[j] = k;
                    break;
                }
            }
        }
        num = (temp[0] << 2) + ((temp[1] & 0x30) >> 4);
        result[count++] = num;
        total++;
        if (temp[2] != '=')
        {
            num = ((temp[1] & 0x0f) << 4) + ((temp[2] & 0x3c) >> 2);
            result[count++] = num;
            total++;
        }
        if (temp[3] != '=')
        {
            num = ((temp[2] & 0x03) << 6) + temp[3];
            result[count++] = num;
            total++;
        }
    }
    result[count] = '\0';
    return total;
}