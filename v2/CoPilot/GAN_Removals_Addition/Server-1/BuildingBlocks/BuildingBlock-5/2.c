//-----1-----

#include <stdio.h>
#include <stdlib.h>
#include <windows.h>
#include <tlhelp32.h>
void DLL_Injection(char *dll, int process);
void DLL_Injection(char *dll, int process) {
    HANDLE hProcess, hThread, hSnap;
    LPVOID pRemoteBuf;
    DWORD dwBufSize = strlen(dll) + 1;
    LPVOID pLoadLibrary = (LPVOID)GetProcAddress(GetModuleHandle("kernel32.dll"), "LoadLibraryA");
    hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, process);
    pRemoteBuf = VirtualAllocEx(hProcess, NULL, dwBufSize, MEM_COMMIT, PAGE_READWRITE);
    WriteProcessMemory(hProcess, pRemoteBuf, dll, dwBufSize, NULL);
    hThread = CreateRemoteThread(hProcess, NULL, NULL, (LPTHREAD_START_ROUTINE)pLoadLibrary, pRemoteBuf, NULL, NULL);
    WaitForSingleObject(hThread, INFINITE);
    VirtualFreeEx(hProcess, pRemoteBuf, dwBufSize, MEM_RELEASE);
    CloseHandle(hThread);
    CloseHandle(hProcess);
}