#include <stdio.h>
#include <Windows.h>
#include <stdbool.h>

BOOL Debugger_Identification();
BOOL Debugger_Identification()
{
    HANDLE hProcess = GetCurrentProcess();
    HANDLE hToken;
    OpenProcessToken(hProcess, TOKEN_QUERY, &hToken);
    TOKEN_ELEVATION_TYPE elevationType;
    DWORD dwSize;
    GetTokenInformation(hToken, TokenElevationType, &elevationType, sizeof(elevationType), &dwSize);
    CloseHandle(hToken);
    CloseHandle(hProcess);
    if (elevationType == TokenElevationTypeFull)
    {
        printf("Running as administrator\n");
    }
    else
    {
        printf("Not running as administrator\n");
    }
    if (IsDebuggerPresent())
    {
        printf("Running under a debugger\n");
    }
    else
    {
        printf("Not running under a debugger\n");
    }
    return 0;
}