# GAN_Removals_Addition

## Introduction

In this experiment, our client initiates a request for a binary. The binary is generated using stored building blocks, facilitated by the first server. Once the binary is generated, our client interacts with the second server using a JSON file containing the required functions and libraries to obfuscate the GAN.

The second server processes a JSON file containing libraries and functions for both addition and removal in the binary to obfuscate the GAN.

* For Removal:
The code on the server side will identify the building block using the specified library and function. It will then modify the prompt accordingly to generate new suggestions, resulting in the removal of the specified elements from the binary.

* For Addition:
The server processes the addition of functions by generating new suggestions based on the provided libraries and functions. These suggestions are used to create an obfuscated version of the binary with the added functions.

This approach ensures that the binary undergoes both addition and removal operations to enhance its obfuscation level and resilience against GAN attacks. Adjustments can be made to the server code to handle specific libraries, functions, and prompts as needed for the experiment.

Additionally, this code framework allows for multiple iterations on the same binary, enabling iterative evaluation and refinement of the obfuscation techniques.

### Note

This repository contains the code for the server-side of the experiment. To facilitate sending the binary each time the client interacts with server1, I have created all possible combinations of C files from the stored Building Blocks.

In this experiment, it's important to note that I am not maintaining a pool of binaries. Instead, I am dynamically creating the binaries as needed during runtime. This means that each request for a binary triggers the creation process, ensuring that fresh binaries are generated on-the-fly rather than being sourced from a pre-existing pool. 

## Repository

### Organization

The repository is organized as follows:

#### Server-1

* **server.py**:
  This file contains the code to activate the server in a VM or individual machine where we want to run the experiemnt.
  
* **BuildingBlocks**:
  This folder has all the variations of the building blocks that can be used to generate the binaries.

* **Prompts**:
  The folder contains prompt files for building blocks, essential for modifying prompts during removal function calls.
  
* **CurrentBuildingBlocks.txt**:
  This file serves as a repository for tracking the current count of building blocks utilized in binary creation. Its purpose is to facilitate prompt modifications as needed during runtime.
  
#### Server-2

* **server.py**:
  This file contains the code to activate the server in a VM or individual machine where we want to run the experiemnt.

##### Code
  
* **Code_generation.py**:
  This Python file is responsible for parsing the JSON data and triggering Copilot to generate suggestions for all the required libraries and functions. It acts as the intermediary between the JSON specifications and the Copilot tool, facilitating the generation of code snippets based on the provided input. This code will combine the suggestions to create a obfuscated binary.
  
* **addition_code_generation.py**:
  This file is utilized to generate suggestions for the addition functions specified in the JSON file.

* **removal_code_generation.py**:
  This file is utilized to generate suggestions for the removal functions specified in the JSON file.

##### Controls

* **Mains**:
  This folder holds the main functions of each individual building blocks. This will enable us to test the building blocks when modified from the removal function call.

* **Prompts**:
  This folder will hold all the modified prompts which will be used in further iterations.

##### Others

* **Main.c**:
  This function holds the main function code that is needed while compiling after generating all the suggestions to create new obfuscated binary.

## Building and Running

### Activating Servers

 1. Navigate to the directory where the servers are located.
 2. Run the following command in the terminal to start the servers:
```python
python server.py
```
Note: Both servers must be activated to conduct the experiment smoothly.

### Hitting Both Servers

After activating the servers, initiate requests to both servers from the machine that has GAN code.

These instructions outline the steps to generate C file combinations, activate the servers, and interact with them for conducting the experiment. Adjust the paths and commands as necessary based on your specific setup and environment.
