#include <Array.au3>

; Reading the file contents
$fileContents = FileRead('C:/Users/Win10/Desktop/Integration-Removals/Server-2/Others/Input.txt')

If @error Then
    MsgBox(16, "Error", "Failed to read the file.")
    Exit
EndIf

; Split the file contents into lines
$lines = StringSplit($fileContents, @CRLF)
$pointData = "" ; Initialize a variable to store the current point's data
Local $points[1]

For $i = 1 To $lines[0]
    ; Check if the current line is not empty
    If $lines[$i] <> "" Then
        ; Check if the line starts with a number followed by a dot and space
        If StringRegExp($lines[$i], "^\d+\.\s") Then
			Local $extractedData = StringRegExpReplace($lines[$i], "^\d+\.\s", "")
			$lines[$i] = $extractedData
            ; If a new point is found, process the previous point's data
            If $pointData <> "" Then
                ; Perform actions using $pointData
                _ArrayAdd($points, $pointData)
                $pointData = ""
            EndIf
        EndIf

        ; Append the current line to $pointData
        $pointData &= $lines[$i]

        ; Add a line break if it's not the last line
        If $i < $lines[0] Then
            $pointData &= @CRLF
        EndIf
    EndIf
Next

; Add the last point to $points if it's not empty
If $pointData <> "" Then
    $points &= $pointData
EndIf
If $pointData <> "" Then
    _ArrayAdd($points, $pointData)
EndIf





For $j=1 To UBound($points) - 1
	If ProcessExists("Code.exe") Then
		; vs code is running
		WinActivate("Welcome - Visual Studio Code")
	Else
		; vs code is not running so starting the application
		Run ("C:\Program Files\Microsoft VS Code\Code.exe")
		WinWaitActive("Welcome - Visual Studio Code")
	EndIf
	sleep(2000)
	Send("^!#n")
	sleep(2000)
	Send("Block.c")
	sleep(2000)
	Send("{ENTER}")
	sleep(2000)
	WinWaitActive("Create File")
	sleep(2000)
	Send('C:\Users\Win10\Desktop\Integration-Removals\Server-2\Others\Block.c')
	sleep(2000)
	Send("{ENTER}")
	Sleep(2000)
	Local $pointLines = StringSplit($points[$j], @CRLF)
	For $k = 1 To $pointLines[0]
		If $pointLines[$k] <> "" Then
			sleep(500)
			send($pointLines[$k])
			Send("{ENTER}")
		EndIf
	Next
	Send("{ENTER}")
	Send("{ENTER}")
	Sleep(3000)
	Send("^{ENTER}")
	Sleep(10000)
	Send("^a")
	Sleep(1000)
	Send("^c")
	Sleep(1000)
	Send("^{F4}")
	Sleep(1000)
	$clipboardText = ClipGet()

	$clipboardText = ClipGet()
	If StringLen($clipboardText) > 0 Then
		$filePath = 'C:/Users/Win10/Desktop/Integration-Removals/Server-2/Others/Suggestions.txt'

		; Open the file in write mode with UTF-8 encoding
		$fileHandle = FileOpen($filePath, 1 + 8)

		If $fileHandle = -1 Then
			; Handle error if needed
			MsgBox(16, "Error", "Failed to open the file.")
		Else
			; Write the entire clipboard content to the file in UTF-8 encoding
			FileWrite($fileHandle, $clipboardText)

			FileClose($fileHandle)
		EndIf
	EndIf
	Send("^s")
	Sleep(5000)
	Send("^{F4}")

Next