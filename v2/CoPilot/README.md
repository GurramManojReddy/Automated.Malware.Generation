# Automatic Malware Generation

## Introduction

The "Automatic Malware Generation Project" represents the second iteration of the paper authored by Professor Marcus Botacin titled "Is Automatic Malware Generation a Threat?" In the original paper, Prof. Botacin utilized prompts to generate the building blocks for malware using ChatGPT. However, in this version, we leverage Copilot to assist in generating the malware.

### Goal
Our objective in this project is to automate Copilot to generate suggestions for the prompts. These suggestions are then consolidated into a single C file, which, when compiled, generates the malware binary. Additionally, we conducted experiments involving a Generative Adversarial Network (GAN) to refine the prompts for malware generation. One such experiment, "GAN_Addition," involves the client (the computer hosting the GAN) and the server (our machine responsible for generating suggestions). Initially, the client requests a binary, and upon receipt, it generates a JSON file containing the functions necessary to be added as dead code to obfuscate the binary. In another experiment, "GAN_Removals_Addition," the GAN also provides outputs specifying libraries to be removed. Subsequently, we analyze the code to identify the blocks utilizing these libraries and adjust the prompt accordingly to generate new suggestions. These suggestions are then compiled into a binary for evaluation by the GAN.


### Author

This project is part of Manoj Reddy Gurram's research work.
Manoj is a Computer Science master candidate at [Texas A&M university](https://www.tamu.edu/index.html), being advised 
by [Prof. Marcus Botacin](http://lasca.ic.unicamp.br/~marcus)

### Note
The code is designed to run on a Windows 10 machine. Additionally, please note that the Copilot automation (our server) is hosted on a virtual machine, and the results are collected from the client side.

## Repository

### Organization

The repository is organized as follows:

* **MalwareGeneration**:
  This code handles the copilot automation responsible for generating input variations for a given building block. These variations are then compiled to produce the desired binaries.

* **GAN_Addition**:
  This is the server-side component responsible for adding dead code to the binary, thereby obfuscating it.

* **GAB_Removals_Addition**:
  This server-side component handles dead code addition and modifies the binaries to generate the obfuscated binary.


### Dependencies

* Binaries are compiled using [GCC](https://gcc.gnu.org/).
* The code requires [Python](https://www.python.org/) to execute the scripts.
* Copilot automation is implemented using [AutoIt](https://www.autoitscript.com/site/) and executed with subprocess in Python.

### Configuring and Building

The configurations and necessary steps required to run the servers for each experiment can be found in their respective README.md files.

## Running

It is crucial to turn off Windows Defender and Real-Time Protection before running this experiment. If these security features are enabled, Windows Defender may detect and delete the generated malware binaries as soon as they are created. Please ensure that Windows Defender and Real-Time Protection are disabled to avoid interference during the experiment.

### Testing

To evaluate the samples generated during the experiment, it's recommended to test them using antivirus software such as VirusTotal. The results obtained from these tests are documented in the research paper. Using VirusTotal or similar platforms provides a comprehensive assessment of the generated samples' detection and classification across multiple antivirus engines.

## Applications

When Generative Adversarial Networks (GANs) are coupled with Language Model (LLM), it enables us to bridge the gap between the Feature-Problem space. This integration is crucial for efficient adversarial Machine Learning-based malware generation.

Please tell me if you are using or referring this project.
